<!doctype html>
<html>
  <head>
    <link href="/favicon.ico" rel="shortcut icon" sizes="16x16 32x32 64x64" />
    <title>Podio Platform Kit â€¢ The Objective-C SDK for Podio Platform</title>
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <div class="wrapper">
      <header>
        <nav>
          <ul>
            <li class=""><a href="/">Getting started</a></li>
            <li class=""><a href="/async">Basic principles of asynchronicity</a></li>
            <li class=""><a href="/authentication">Authentication &amp; session management</a></li>
            <li class=""><a href="/storage">Local storage  &amp; caching</a></li>
            <li class=""><a href="/push">Push</a></li>
            <li class=""><a href="/items">Working with apps &amp; items</a></li>
            <li class=""><a href="/fields">Item field examples</a></li>
            <li class=""><a href="/files">Working with files</a></li>
            <li class=""><a href="/comments">Working with comments</a></li>
            <li class=""><a href="/debug">Debugging &amp; errors</a></li>
          </ul>
        </nav>
        <p>You have found Podio Platform Kit, the official Objective-C SDK for <a href="https://platform.podio.com/">Podio Platform</a>. It works with both iOS and Mac OS X.</p>
        <p>
          <a href="https://travis-ci.org/podio/podio-objc-platform"><img src="https://travis-ci.org/podio/podio-objc.png?branch=master" alt="Build Status"></a>
        </p>
        <p>For help post on <a href="http://stackoverflow.com/questions/tagged/podio">Stack Overflow</a> and tag with <b>podio</b>. For bugs <a href="https://github.com/podio/podio-objc-platform/issues">create an issue on GitHub</a>.</p>
        <ul class="buttons">
          <li><a class="download" href="https://github.com/podio/podio-objc-platform/releases">Download</a></li>
          <li><a class="github" href="https://github.com/podio/podio-objc-platform">GitHub</a></li>
        </ul>
      </header>
      <main>
        <h1 id="working-with-files">Working with Files</h1>

<p>Files on Podio are represented by the <code>PKCFile</code> class in PodioPlatformKit. It will be the type returned for the files of any object that can have associated files such as items, tasks or comments etc.</p>

<h2 id="download-a-file">Download a file</h2>

<p>To download the contents of a file from Podio you have two options. The first one is to download the content directly into memory and get an <code>NSData</code> object back. This is appropriate for smaller files and can be done with the following code:</p>

<div class="highlight"><pre><code class="objective-c"><span class="n">PKCFile</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">PKCAsyncTask</span> <span class="o">*</span><span class="n">downloadTask</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="n">download</span><span class="p">];</span>

<span class="p">[</span><span class="n">downloadTask</span> <span class="n">onComplete</span><span class="o">:^</span><span class="p">(</span><span class="n">NSData</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Success, do something the data...</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Something went wrong, handle error...</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre></div>

<p>The second option is to save the file directly to disk to avoid keeping its data in memory and risking termination by the OS due to excessive memory use. To do this, there is a second download method on <code>PKCFile</code> which allows you to specify a save path:</p>

<div class="highlight"><pre><code class="objective-c"><span class="n">PKCFile</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">NSString</span> <span class="o">*</span><span class="n">savePath</span> <span class="o">=</span> <span class="p">...;</span> <span class="c1">// The local file path where you wish to save the file</span>

<span class="n">PKCAsyncTask</span> <span class="o">*</span><span class="n">downloadTask</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="n">downloadToFileWithPath</span><span class="o">:</span><span class="n">savePath</span><span class="p">];</span>

<span class="p">[</span><span class="n">downloadTask</span> <span class="n">onComplete</span><span class="o">:^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">success</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Success, now we can load it from disk as needed...</span>
    <span class="n">NSData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSData</span> <span class="n">dataWithContentsOfFile</span><span class="o">:</span><span class="n">savePath</span><span class="p">];</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Something went wrong, handle error...</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre></div>

<h2 id="upload-a-file">Upload a file</h2>

<p>You can easily upload a file to Podio to attach to an item or comment. To do so, just use the upload methods provided by the <code>PKCFile</code> class. Here is an example on how you can upload a UIImage instance as a JPEG to Podio on iOS:</p>

<div class="highlight"><pre><code class="objective-c"><span class="n">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="n">imageNamed</span><span class="o">:</span><span class="s">@&quot;some-image.jpg&quot;</span><span class="p">];</span>
<span class="n">NSData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">UIImageJPEGRepresentation</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">0.8f</span><span class="p">);</span>

<span class="n">PKCAsyncTask</span> <span class="o">*</span><span class="n">uploadTask</span> <span class="o">=</span> <span class="p">[</span><span class="n">PKCFile</span> <span class="n">uploadWithData</span><span class="o">:</span><span class="n">data</span> <span class="n">fileName</span><span class="o">:</span><span class="s">@&quot;image.jpg&quot;</span><span class="p">];</span>

<span class="p">[</span><span class="n">uploadTask</span> <span class="n">onComplete</span><span class="o">:^</span><span class="p">(</span><span class="n">PKCFile</span> <span class="o">*</span><span class="n">file</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;File uploaded with ID: %@&quot;</span><span class="p">,</span> <span class="p">@(</span><span class="n">file</span><span class="p">.</span><span class="n">fileID</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre></div>

<p>To add a file to an item, use the <code>addFile:</code> method on <code>PKCItem</code>:</p>

<div class="highlight"><pre><code class="objective-c"><span class="n">PKCItem</span> <span class="o">*</span><span class="n">item</span> <span class="o">=</span> <span class="p">...</span>
<span class="n">PKCFile</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="p">...</span>

<span class="p">[</span><span class="n">item</span> <span class="n">addFile</span><span class="o">:</span><span class="n">file</span><span class="p">];</span>

<span class="p">[[</span><span class="n">item</span> <span class="n">save</span><span class="p">]</span> <span class="n">onComplete</span><span class="o">:^</span><span class="p">(</span><span class="n">PKCResponse</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">){</span>
  <span class="c1">// Item saved with the file added</span>
<span class="p">}];</span>
</code></pre></div>

<p>You can also attach a file to any object by supplying its reference type and ID:</p>

<div class="highlight"><pre><code class="objective-c"><span class="n">PKCFile</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="p">...</span>

<span class="n">PKCAsyncTask</span> <span class="o">*</span><span class="n">attachTask</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="n">attachWithReferenceID</span><span class="o">:</span><span class="mi">1234</span> <span class="n">referenceType</span><span class="o">:</span><span class="n">PKCReferenceTypeItem</span><span class="p">];</span>

<span class="p">[</span><span class="n">attachTask</span> <span class="n">onComplete</span><span class="o">:^</span><span class="p">(</span><span class="n">PKCResponse</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// File successfully attached to item with ID 1234</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre></div>

      </main>
    </div>
  </body>
</html>
